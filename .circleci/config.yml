version: 2.1

orbs:
  matlab: mathworks/matlab@0.2.1
  
jobs:
  build:
    machine:
      image: 'ubuntu-2004:202010-01'
    resource_class: medium
    steps:
      - checkout
      - matlab/install:
          release: "2020a"
      - run: matlab -batch "addpath([genpath('source') genpath('tests')]), savepath pathdef.m;"
      - matlab/run-tests: -nodisplay -batch
          test-results-junit: tests/matlab/results.xml
          code-coverage-cobertura: tests/matlab/coverage.xml      
      - store_test_results:
          path: tests

