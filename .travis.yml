language: python
jobs:
  include:
  - stage: pages
    install:
    - pip install docutils<0.17 sphinxcontrib-matlabdomain sphinxext-remoteliteralinclude sphinx-multiversion sphinxcontrib-bibtex sphinx_rtd_theme
    script:
    - git remote
    - mkdir html
    - sphinx-multiversion -D "smv_remote_whitelist=r'^(origin)$'" docs/ html/
    before_deploy:
    - touch html/.nojekyll
    - cp assets/gh-pages-redirect.html html/index.html
    deploy:
    - provider: pages
      skip_cleanup: true
      github_token: $GITHUB_TOKEN
      keep_history: false
      local_dir: html
    if: "(branch = sphinx-multiversion) AND type = push"

