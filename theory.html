

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; WEC-Sim  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/table_wrap.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code Structure" href="code_structure.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> WEC-Sim
          

          
          </a>

          
            
            
              <div class="version">
                v4.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#coordinate-system">Coordinate System</a></li>
<li class="toctree-l2"><a class="reference internal" href="#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-element-method-bem">Boundary Element Method (BEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-domain-formulation">Time-Domain Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-methods">Numerical Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ramp-function">Ramp Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sinusoidal-steady-state-response">Sinusoidal Steady-State Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convolution-integral-formulation">Convolution Integral Formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-space">State Space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calculation-of-k-r-from-state-space-matrices">Calculation of <img class="math" src="_images/math/823642569004dcf6ef16716b13ae373f63d9e1d5.png" alt="K_{r}"/> from State Space Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#realization-theory">Realization Theory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#regular-waves">Regular Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#irregular-waves">Irregular Waves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wave-spectra">Wave Spectra</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pierson-moskowitz-pm">Pierson–Moskowitz (PM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jonswap-js">JONSWAP (JS)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#power-take-off-pto">Power Take-Off (PTO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear-pto">Linear PTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hydraulic-pto">Hydraulic PTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mechanical-pto">Mechanical PTO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mooring">Mooring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mooring-matrix">Mooring Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">MoorDyn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nonlinear-buoynancy-and-froude-krylov-wave-excitation">Nonlinear Buoynancy and Froude-Krylov Wave Excitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viscous-damping-and-morison-elements">Viscous Damping and Morison Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#viscous-damping">Viscous Damping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#morison-elements">Morison Elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generalized-body-modes">Generalized Body Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_structure.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_features.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinars.html">Webinars</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Online Forum</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">WEC-Sim API</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WEC-Sim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<p>Modeling wave energy converters (WECs) involves the interaction between the incident waves, device motion, power-take-off (PTO mechanism), and mooring. WEC-Sim uses a radiation and diffraction method <a class="bibtex reference internal" href="#li2012" id="id2">[2]</a><a class="bibtex reference internal" href="#babarit2012" id="id3">[3]</a> to predict power performance and design optimization. The radiation and diffraction method generally obtains the hydrodynamic forces from a frequency-domain boundary element method (BEM) solver using linear coefficients to solve the system dynamics in the time domain.</p>
<div class="figure align-center" id="wec-sim-methodology">
<img alt="_images/Physics.png" src="_images/Physics.png" />
</div>
<div class="section" id="coordinate-system">
<h2>Coordinate System<a class="headerlink" href="#coordinate-system" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#id4"><span class="std std-ref">WEC-Sim Coordinate System</span></a> figure illustrates a 3-D floating point absorber subject to incoming waves in water. The figure also defines the coordinates and the 6 degree of freedom (DOF) in WEC-Sim. The WEC-Sim coordinate system assumes that the positive X-axis defines a wave angle heading of zero (e.g., a wave propagating with along a zero-degree direction is moving in the +X direction). The positive Z-axis is in the vertical upwards direction, and the positive Y-axis direction is defined by the right-hand rule. In the vectors and matrices used in the code, Surge (x), Sway (y), and Heave (z) correspond to the first, second and third position respectively. Roll (Rx), Pitch (Ry), and Yaw (Rz) correspond to the fourth, fifth, and sixth position respectively.</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/coordinateSystem.png"><img alt="_images/coordinateSystem.png" src="_images/coordinateSystem.png" style="width: 200pt;" /></a>
<div class="legend">
<p><em>WEC-Sim Coordinate System</em></p>
</div>
</div>
</div>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>All units within WEC-Sim are in the MKS (meters-kilograms-seconds system) and angular measurements are specified in radians (except for wave directionality which is defined in degrees).</p>
</div>
<div class="section" id="boundary-element-method-bem">
<h2>Boundary Element Method (BEM)<a class="headerlink" href="#boundary-element-method-bem" title="Permalink to this headline">¶</a></h2>
<p>In WEC-Sim, wave forcing components are modeled using linear coefficients  obtained from a frequency-domain potential flow Boundary Element Method (BEM) solver (e.g., WAMIT <a class="bibtex reference internal" href="#lee2006" id="id5">[4]</a>, AQWA <a class="bibtex reference internal" href="#aqwa" id="id6">[5]</a>, and Nemoh <a class="bibtex reference internal" href="#nemoh" id="id7">[6]</a>).
The BEM solutions are obtained by solving the Laplace equation for the velocity potential, which assumes the flow is inviscid, incompressible, and irrotational. More details on the theory for the frequency-domain BEM can be found in <a class="bibtex reference internal" href="#lee2006" id="id8">[4]</a>.</p>
<p>WEC-Sim imports non-dimensionalized hydrodynamic coefficients from an <code class="docutils literal notranslate"><span class="pre">*.h5</span></code>  data structure generated by <a class="reference internal" href="advanced_features.html#bemio"><span class="std std-ref">BEMIO</span></a> for the WAMIT, AQWA or Nemoh BEM solvers.
Alternatively, the <code class="docutils literal notranslate"><span class="pre">*.h5</span></code> data structure can be manually defined by the user.
The WEC-Sim code scales the hydrodynamic coefficients according to the equations below, where <img class="math" src="_images/math/27dc86f9f1b1c3435b2403a869b5870c582facea.png" alt="\rho"/> is the water density, <img class="math" src="_images/math/16cb1e006199f0853a2dc67ea814446a38beb54e.png" alt="\omega"/> is the wave frequency in rad/s, and <img class="math" src="_images/math/157ba5711de84b4c715a0478fd8ae440e596d96e.png" alt="g"/> is gravity:</p>
<div class="math">
<p><img src="_images/math/7913be94da449965d7bb96804712db66a6546db1.png" alt="|\overline{F_{exc}(\omega)}|=\frac{|F_{exc}(\omega)|}{\rho g}

\overline{A(\omega)} = \frac{A(\omega)}{\rho}

\overline{B(\omega)} = \frac{B(\omega)}{\rho \omega}

\overline{K_{hs}} = \frac{K_{hs}}{\rho g}"/></p>
</div><p>where <img class="math" src="_images/math/f3e9f0a5123fc1d6cb4ebe8334c50ca4bb44ec1a.png" alt="F_{exc}"/> is the wave-excitation force/torque coefficient, <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> is the radiation added mass coefficient, <img class="math" src="_images/math/4bc3e94a67870b41b7c20179693e889251e2c136.png" alt="B"/> is the radiation wave damping coefficient, and <img class="math" src="_images/math/ceedc94b887fcb5ee84b239ae7a182b55141cf63.png" alt="K_{hs}"/> is the linear hydrostatic restoring coefficient.</p>
</div>
<div class="section" id="time-domain-formulation">
<h2>Time-Domain Formulation<a class="headerlink" href="#time-domain-formulation" title="Permalink to this headline">¶</a></h2>
<p>A common approach to determining the hydrodynamic forces is to use linear wave theory which assumes the waves are the sum of incident, radiated, and diffracted wave components.
The dynamic response of the system is calculated by solving WEC system equations of motion <a class="bibtex reference internal" href="#babarit2012" id="id9">[3]</a><a class="bibtex reference internal" href="#nolte2014" id="id10">[7]</a>.
The equation of motion for a floating body about its center of gravity can be given as:</p>
<div class="math">
<p><img src="_images/math/9171fa20158e46a0877a6587a0e89f88a3b66e6b.png" alt="m\ddot{X}=F_{exc}(t)+F_{rad}(t)+F_{pto}(t)+F_{v}(t)+F_{me}(t)+F_{B}(t)+F_{m}(t)"/></p>
</div><p>where <img class="math" src="_images/math/b0e89c576a1cd56948a99378a16088b8c619202d.png" alt="\ddot{X}"/> is the (translational and rotational) acceleration vector of the device, <img class="math" src="_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/> is the mass matrix, <img class="math" src="_images/math/61fc51b4402569289d7cd1c0711f0e3a3013c8c9.png" alt="F_{exc}(t)"/> is the wave excitation force and torque (6-element) vector, <img class="math" src="_images/math/a64a05b4e1b20d9a1b4d7467db7f1b1acc3daaf6.png" alt="F_{rad}(t)"/> is the force and torque vector resulting from wave radiation, <img class="math" src="_images/math/109183de51e950f7afe2f38bfb17cb49640d8e2a.png" alt="F_{pto}(t)"/> is the PTO force and torque vector, <img class="math" src="_images/math/b73c5222827ba73e02ed200f31493b726c641681.png" alt="F_{v}(t)"/> is the damping force and torque vector, <img class="math" src="_images/math/b6ccd6e8c2d02e35640962052ebb6641643e2774.png" alt="F_{me}(t)"/> is the Morison Element force and torque vector, <img class="math" src="_images/math/495c2e374bebd6616447daf3bfd914f34651be10.png" alt="F_{B}(t)"/> is the net buoyancy restoring force and torque vector, and <img class="math" src="_images/math/f04ac51b4efa81f32dc0d73c49b1c10cd988bf40.png" alt="F_{m}(t)"/> is the force and torque vector resulting from the mooring connection.</p>
<p><img class="math" src="_images/math/61fc51b4402569289d7cd1c0711f0e3a3013c8c9.png" alt="F_{exc}(t)"/> , <img class="math" src="_images/math/a64a05b4e1b20d9a1b4d7467db7f1b1acc3daaf6.png" alt="F_{rad}(t)"/> , and <img class="math" src="_images/math/495c2e374bebd6616447daf3bfd914f34651be10.png" alt="F_{B}(t)"/> are calculated using hydrodynamic coefficients provided by the frequency-domain BEM solver.
The radiation term includes an added-mass term, matrix <img class="math" src="_images/math/bcea46bf3076bb1a8aa7ebb2e4369ddd86c525b7.png" alt="A(\omega)"/>, and wave damping term, matrix <img class="math" src="_images/math/67c6ee23aef5e1c70c2b9debe8fd12e9b1ec61a1.png" alt="B(\omega)"/>, associated with the acceleration and velocity of the floating body, respectively, and given as functions of radian frequency (<img class="math" src="_images/math/16cb1e006199f0853a2dc67ea814446a38beb54e.png" alt="\omega"/>) by the BEM solver.
The wave excitation term <img class="math" src="_images/math/c7401756d61feb6d2bf993fd9d5bdd98c351a21f.png" alt="F_{exc}(\omega)"/> includes a Froude-Krylov force component generated by the undisturbed incident waves and a diffraction component that results from the presence of the floating body.
The buoyancy term <img class="math" src="_images/math/495c2e374bebd6616447daf3bfd914f34651be10.png" alt="F_{B}(t)"/> depends on the hydrostatic stiffness <img class="math" src="_images/math/ceedc94b887fcb5ee84b239ae7a182b55141cf63.png" alt="K_{hs}"/> coefficient, displacement of the body, and its mass.</p>
</div>
<div class="section" id="numerical-methods">
<h2>Numerical Methods<a class="headerlink" href="#numerical-methods" title="Permalink to this headline">¶</a></h2>
<p>WEC-Sim can be used for regular and irregular wave simulations, but note that <img class="math" src="_images/math/61fc51b4402569289d7cd1c0711f0e3a3013c8c9.png" alt="F_{exc}(t)"/> and <img class="math" src="_images/math/a64a05b4e1b20d9a1b4d7467db7f1b1acc3daaf6.png" alt="F_{rad}(t)"/> are calculated differently for sinusoidal steady-state response scenarios and random sea simulations.
The sinusoidal steady-state response is often used for simple WEC designs with regular incoming waves.
However, for random sea simulations or any simulations where fluid memory effects of the system are essential, the convolution integral method is recommended to represent the fluid memory retardation force on the floating body.
To speed computation of the convolution integral, the state space representation method can be specified to approximate this calculation as a system of linear ordinary differential equations.</p>
<div class="section" id="ramp-function">
<h3>Ramp Function<a class="headerlink" href="#ramp-function" title="Permalink to this headline">¶</a></h3>
<p>A ramp function (<img class="math" src="_images/math/dbd7088581bcf7009343e810f44a8c9d78dbb901.png" alt="R_{f}"/>), necessary to avoid strong transient flows at the earlier time steps of the simulation, is used to calculate the wave excitation force. The ramp function is given by</p>
<div class="math">
<p><img src="_images/math/03be679bb93bcc4c546d30541eda4bb5bf26d550.png" alt="R_{f}(t)=\begin{cases}
\frac{1}{2}(1+\cos(\pi+\frac{\pi t}{t_{r}}) &amp; \frac{t}{t_{r}}&lt;1\\
1 &amp; \frac{t}{t_{r}}\geq1
\end{cases}"/></p>
</div><p>where <img class="math" src="_images/math/907a4add6d5db5b7f197f7924f1371b8ac404fe6.png" alt="t"/> is the simulation time and <img class="math" src="_images/math/4bbd84ea2dddb722185b78c9d7d82d06818660e8.png" alt="t_{r}"/> is the ramp time.</p>
</div>
<div class="section" id="sinusoidal-steady-state-response">
<h3>Sinusoidal Steady-State Response<a class="headerlink" href="#sinusoidal-steady-state-response" title="Permalink to this headline">¶</a></h3>
<p>This approach assumes that the system response is in sinusoidal steady-state form; therefore, it is only valid for regular wave simulations. The radiation term can be calculated using the added mass and the wave radiation damping term for a given wave frequency, which is obtained from</p>
<div class="math">
<p><img src="_images/math/059ce2f949fa19c0e61ced797a3046eccb31e29e.png" alt="F_{rad}(t)=-A(\omega)\ddot{X}-B(\omega)\dot{X}"/></p>
</div><p>where <img class="math" src="_images/math/30be2b605c44fee9ec1ee785140bd3a4e404a30a.png" alt="\dot{X}"/> is the velocity vector of the floating body.</p>
<p>The free surface profile is based on linear wave theory for a given wave height, wave frequency, and water depth. The regular wave excitation force is obtained from</p>
<div class="math">
<p><img src="_images/math/9ce958fef8ce427e75eff31cb58568f4d1913d71.png" alt="F_{exc}(t)=\Re\left[ R_{f}(t)\frac{H}{2}F_{exc}(\omega, \theta)e^{i\omega t} \right]"/></p>
</div><p>where <img class="math" src="_images/math/2d25e98c75d80bb207e078ac126e0d3a3ae3ea08.png" alt="\Re"/> denotes the real part of the formula, <img class="math" src="_images/math/dbd7088581bcf7009343e810f44a8c9d78dbb901.png" alt="R_{f}"/> is the ramp function, <img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> is the wave height, <img class="math" src="_images/math/f3e9f0a5123fc1d6cb4ebe8334c50ca4bb44ec1a.png" alt="F_{exc}"/> is the frequency dependent complex wave-excitation amplitude vector, and <img class="math" src="_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> is the wave direction.</p>
</div>
<div class="section" id="convolution-integral-formulation">
<h3>Convolution Integral Formulation<a class="headerlink" href="#convolution-integral-formulation" title="Permalink to this headline">¶</a></h3>
<p>To include the fluid memory effect, the convolution integral formulation based upon the Cummins equation <a class="bibtex reference internal" href="#cummins1962" id="id11">[8]</a> is used. The radiation term can be calculated by</p>
<div class="math">
<p><img src="_images/math/6e5abc41cf719c210be90596340e2a16c862b8e0.png" alt="F_{rad}(t)=-A_{\infty}\ddot{X}-\intop_{0}^{t}K_{r}(t-\tau)\dot{X}(\tau)d\tau"/></p>
</div><p>where <img class="math" src="_images/math/ea25e9d39a7d8394857af4a54c5f5ac599a6c236.png" alt="A_{\infty}"/> is the added mass matrix at infinite frequency and <img class="math" src="_images/math/823642569004dcf6ef16716b13ae373f63d9e1d5.png" alt="K_{r}"/> is the radiation impulse response function. This representation also assumes that there is no motion for <img class="math" src="_images/math/79da77dd06a7ae9b007d909c494eb85012db5ca4.png" alt="t&lt;0"/>.</p>
<p>For regular waves, the equation described in the last subsection is used to calculate the wave excitation vector.
For irregular waves, the free surface elevation is constructed from a linear superposition of a number of regular wave components.
Each regular wave component is extracted from a wave spectrum, <img class="math" src="_images/math/0d5ab96d3aeec3a1854a81e6b383aea45e595fee.png" alt="S(\omega)"/>, describing the wave energy distribution over a range of wave frequencies, generally characterized by a significant wave height and peak wave period. The irregular excitation force can be calculated as the real part of an integral term across all wave frequencies as follows</p>
<div class="math">
<p><img src="_images/math/8550863958162a822628fbbe57fb3a24d74f17a0.png" alt="F_{exc}(t)=\Re\left[ R_{f}(t) \sum_{j=1}^{N}F_{exc}(\omega_{j}, \theta)e^{i(\omega_{j}t+\phi_{j})} \sqrt{2S(\omega_{j})d\omega_{j}} \right]"/></p>
</div><p>where <img class="math" src="_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/> is the randomized phase angle and <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> is the number of frequency bands selected to discretize the wave spectrum. For repeatable simulation of an irregular wave field <img class="math" src="_images/math/0d5ab96d3aeec3a1854a81e6b383aea45e595fee.png" alt="S(\omega)"/>, WEC-Sim allows specification of <img class="math" src="_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/>, refer to the <a class="reference internal" href="advanced_features.html#seeded-phase"><span class="std std-ref">Irregular Waves with Seeded Phase</span></a> section.</p>
</div>
<div class="section" id="state-space">
<h3>State Space<a class="headerlink" href="#state-space" title="Permalink to this headline">¶</a></h3>
<p>It is highly desirable to represent the radiation convolution integral described in the last subsection in state space (SS) form <a class="bibtex reference internal" href="#yu1996" id="id12">[9]</a>.  This has been shown to dramatically increase computational speeds <a class="bibtex reference internal" href="#taghipour2008" id="id13">[10]</a> and allow utilization of conventional control methods that rely on linear state space models.  An approximation will need to be made as <img class="math" src="_images/math/823642569004dcf6ef16716b13ae373f63d9e1d5.png" alt="K_{r}"/> is solved from a set of partial differential equations where as a <cite>linear state space</cite> is constructed from a set of ordinary differential equations.  In general, a linear system is desired such that:</p>
<div class="math">
<p><img src="_images/math/25bfec8cefd8d71c971ded72565d2579a50f373b.png" alt="\dot{X}_{r} \left( t \right) = \mathbf{A_{r}} X_{r} \left( t \right) + \mathbf{B_{r}} \mathbf{u} (t);~~X_{r}\left( 0 \right) = 0~~ \nonumber \\
\int_{0}^{t} \mathbf{K_{r}} \left( t- \tau \right) d\tau \approx \mathbf{C_{r}} X_{r} \left( t \right) + \mathbf{D_{r}} \mathbf{u} \left( t \right)~~"/></p>
</div><p>with <img class="math" src="_images/math/30ea5be03f1f3d489bc8c716b14e777ddce856e6.png" alt="\mathbf{A_{r}},~\mathbf{B_{r}},~\mathbf{C_{r}},~\mathbf{D_{r}}"/> being the time-invariant state, input, output, and feed through matrices, while <img class="math" src="_images/math/9b444cf6329a14140aee8ff5a06ff30772cc1c2f.png" alt="u"/> is the input to the system and <img class="math" src="_images/math/3775ce2126011f6a1e8108929970dc072c76857d.png" alt="X_{r}"/> is the state vector describing the convolution kernal as time progresses.</p>
<div class="section" id="calculation-of-k-r-from-state-space-matrices">
<h4>Calculation of <img class="math" src="_images/math/823642569004dcf6ef16716b13ae373f63d9e1d5.png" alt="K_{r}"/> from State Space Matrices<a class="headerlink" href="#calculation-of-k-r-from-state-space-matrices" title="Permalink to this headline">¶</a></h4>
<p>The impulse response of a single-input zero-state state-space model is represented by</p>
<div class="math">
<p><img src="_images/math/9698af54e623fe2c49cad7637ce56292aac16cf3.png" alt="\dot{x} =  \mathbf{A_{r}}x + \mathbf{B_{r}} u~~ \\
y = \mathbf{C_{r}}x~~"/></p>
</div><p>where <img class="math" src="_images/math/9b444cf6329a14140aee8ff5a06ff30772cc1c2f.png" alt="u"/> is an impulse. If the initial state is set to <img class="math" src="_images/math/54788e03277b8d717bd1e8dead729fd1e43f8342.png" alt="x(0)= \mathbf{B_{r}} u"/> the response of the unforced (<img class="math" src="_images/math/076c649db46dcc9dd32aa9e5000c936e8e369ee3.png" alt="u=0"/>) system</p>
<div class="math">
<p><img src="_images/math/cea9e12665b34f048696b40513953565d3b54fce.png" alt="\dot{x} = \mathbf{A_{r}} x~~, \\
y = \mathbf{C_{r}} x~~"/></p>
</div><p>is clearly equivalent to the zero-state impulse response. The impulse response of a continuous system with a nonzero <img class="math" src="_images/math/6945b5ca0e04ac65418be3c5d4072352c5920e6d.png" alt="\mathbf{D_r}"/> matrix is infinite at <img class="math" src="_images/math/34656d3b192f255d26caf50b0ed5476d5d789d11.png" alt="t=0"/>; therefore, the lower continuity value <img class="math" src="_images/math/a60d53f980d83c762efe47ef473df3500a35e3e1.png" alt="\mathbf{C_{r}}\mathbf{B_{r}}"/> is reported at <img class="math" src="_images/math/34656d3b192f255d26caf50b0ed5476d5d789d11.png" alt="t=0"/>. The general solution to a linear time invariant (LTI) system is given by:</p>
<div class="math">
<p><img src="_images/math/ccca31bf9ac107bcb344427ce651f6b417148d54.png" alt="x(t) = e^{\mathbf{A_{r}}t} x(0) + \int_{0}^{t} e^{\mathbf{A_{r}}(t-\tau)} \mathbf{B_{r}} u (\tau) d\tau~~"/></p>
</div><p>where <img class="math" src="_images/math/b1bba9bf88c38664f322c9e028057e9926ad31f8.png" alt="e^{\mathbf{A_{r}}}"/> is the matrix exponential and the calculation of <img class="math" src="_images/math/823642569004dcf6ef16716b13ae373f63d9e1d5.png" alt="K_{r}"/> follows:</p>
<div class="math">
<p><img src="_images/math/9610a07e9dc52ce0f4e727d4d3eddd604c4dca36.png" alt="K_{r}(t) = \mathbf{C_{r}}e^{\mathbf{A_{r}}t}\mathbf{B_{r}}~~"/></p>
</div></div>
<div class="section" id="realization-theory">
<h4>Realization Theory<a class="headerlink" href="#realization-theory" title="Permalink to this headline">¶</a></h4>
<p>The state space realization of the hydrodynamic radiation coefficients can be pursued in the time domain (TD). This consists of finding the minimal order of the system and the discrete time state matrices (<img class="math" src="_images/math/faa93db441f69d2339065a343d1c47b888949899.png" alt="\mathbf{A_{d}},~\mathbf{B_{d}},~\mathbf{C_{d}},~\mathbf{D_{d}}"/>) from samples of the impulse response function.  This problem is easier to handle for a discrete-time system than for continuous-time. The reason being is that the impulse response function of a discrete-time system is given by the Markov parameters of the system:</p>
<div class="math">
<p><img src="_images/math/a3af49c99a2f55502b2bc7b0998d18c40d9d9191.png" alt="\mathbf{\tilde{K}_{r}} \left( t_{k} \right) = \mathbf{C_{d}}\mathbf{A_{d}}^{k}\mathbf{B_{d}}~~"/></p>
</div><p>where <img class="math" src="_images/math/88d4d8c3ff5b70f1e194a7a4b41052bb30820d50.png" alt="t_{k}=k\Delta t"/> for <img class="math" src="_images/math/dd27e184b7583ac83990f25c97b0c34531ff4bb3.png" alt="k=0,~1,~2,~\ldots"/> with <img class="math" src="_images/math/b4ed9c2e208e08edeca8b1550ec0840acd090276.png" alt="\Delta t"/> being the sampling period.  The feedthrough matrix <img class="math" src="_images/math/90a3c5cddc044e1ad34b6e735b34bc3bbf961fb7.png" alt="\mathbf{D_d}"/> is assumed to be zero in order to maintain causality of the system, as a non-zero <img class="math" src="_images/math/90a3c5cddc044e1ad34b6e735b34bc3bbf961fb7.png" alt="\mathbf{D_d}"/> results in an infinite value at <img class="math" src="_images/math/34656d3b192f255d26caf50b0ed5476d5d789d11.png" alt="t=0"/>.</p>
<p>The most common algorithm to obtain the realization is to perform a Singular Value Decomposition (SVD) on the Hankel matrix of the impulse response function, as proposed by Kung <a class="bibtex reference internal" href="#kung1978" id="id14">[11]</a>.  The order of the system and state-space parameters are determined from the number of significant singular values and the factors of the SVD.  The Hankel matrix (<img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/>) of the impulse response function</p>
<div class="math">
<p><img src="_images/math/92d94f0e1117fc04456431fbf0c99864ac4865d2.png" alt="H = \begin{bmatrix}
        \mathbf{K_{r}}(2) &amp; \mathbf{K_{r}}(3) &amp; \ldots &amp; \mathbf{K_{r}}(n) \\
        \mathbf{K_{r}}(3) &amp; \mathbf{K_{r}}(4) &amp; \ldots &amp; 0 \\
        \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
        \mathbf{K_{r}}(n) &amp; 0 &amp; \cdots &amp; 0
\end{bmatrix} &amp;\\"/></p>
</div><p>can be reproduced exactly by the SVD as</p>
<div class="math">
<p><img src="_images/math/4aaaa71524ffa75b06ce8e0b97d62b6376274110.png" alt="H = \mathbf{U} \Sigma \mathbf{V^{*}}"/></p>
</div><p>where <img class="math" src="_images/math/6edc5c119344e25a06e6ac4cb56f2d5e2f09a2f1.png" alt="\Sigma"/> is a diagonal matrix containing the Hankel singular values in descending order.  Examination of the Hankel singular values reveals there are only a small number of significant states and that the rank of <img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> can be greatly reduced without a significant loss in accuracy <a class="bibtex reference internal" href="#taghipour2008" id="id15">[10]</a><a class="bibtex reference internal" href="#kristiansen2005" id="id16">[12]</a>. Further detail into the SVD method and calculation of the state space parameters will not be discussed here and the reader is referred to <a class="bibtex reference internal" href="#taghipour2008" id="id17">[10]</a><a class="bibtex reference internal" href="#kristiansen2005" id="id18">[12]</a>.</p>
</div>
</div>
</div>
<div class="section" id="regular-waves">
<h2>Regular Waves<a class="headerlink" href="#regular-waves" title="Permalink to this headline">¶</a></h2>
<p>Regular waves are defined as planar sinusoidal waves, where the incident wave is defined as <img class="math" src="_images/math/0e39eb9e11d3b1fe8c88f1b6b1998bd9307dcd89.png" alt="\eta(x,y,t)"/> :</p>
<div class="math">
<p><img src="_images/math/c7d1fdd9234dee268955381a7c0fc542d4ac7d06.png" alt="\eta(x,y,t)= \frac{H}{2} \cos( \omega t - k (x\cos \theta + y\sin \theta) + \phi)"/></p>
</div><p>where <img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> is the wave height, <img class="math" src="_images/math/16cb1e006199f0853a2dc67ea814446a38beb54e.png" alt="\omega"/> is the wave frequency  (<img class="math" src="_images/math/3caa105bc2613b1b2a6546abe3455f7e8d0f906b.png" alt="\omega = \frac{2\pi}{T}"/>), <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> is the wave number (<img class="math" src="_images/math/fe6830b375b29fd23a807ebb01d911b401102769.png" alt="k = \frac{2\pi}{\lambda}"/>), <img class="math" src="_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> is the wave direction, and <img class="math" src="_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/> is the wave phase.</p>
</div>
<div class="section" id="irregular-waves">
<h2>Irregular Waves<a class="headerlink" href="#irregular-waves" title="Permalink to this headline">¶</a></h2>
<p>Irregular waves are modeled as the linear superposition of a large number of harmonic waves at different frequencies and angles of incidence, where the incident wave is defined as <img class="math" src="_images/math/0e39eb9e11d3b1fe8c88f1b6b1998bd9307dcd89.png" alt="\eta(x,y,t)"/> :</p>
<div class="math">
<p><img src="_images/math/705689c311ddf1ca9600fc70a869db725e2894d4.png" alt="\eta(x,y,t)= \sum_{i}\frac{H_{i}}{2} \cos( \omega_{i} t - k_{i} (x\cos \theta_{i} + y\sin \theta_{i}) + \phi_{i})"/></p>
</div><p>where <img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> is the wave height, <img class="math" src="_images/math/16cb1e006199f0853a2dc67ea814446a38beb54e.png" alt="\omega"/> is the wave frequency  (<img class="math" src="_images/math/3caa105bc2613b1b2a6546abe3455f7e8d0f906b.png" alt="\omega = \frac{2\pi}{T}"/>), <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> is the wave number (<img class="math" src="_images/math/fe6830b375b29fd23a807ebb01d911b401102769.png" alt="k = \frac{2\pi}{\lambda}"/>), <img class="math" src="_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> is the wave direction, and <img class="math" src="_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/> is the wave phase (randomized for irregular waves).</p>
<div class="section" id="wave-spectra">
<h3>Wave Spectra<a class="headerlink" href="#wave-spectra" title="Permalink to this headline">¶</a></h3>
<p>The linear superposition of regular waves of distinct amplitudes and periods is characterized in the frequency domain by a wave spectrum. Through statistical analysis, spectra are characterized by specific parameters such as significant wave height, peak period, wind speed, fetch length, and others. Common types of wave spectra that are used by the offshore industry are discussed in the following sections.  The general form of the wave spectra available in WEC-Sim is given by:</p>
<div class="math">
<p><img src="_images/math/d0e7eed555e1d9ceaded2c78c424d093b2525cd9.png" alt="S\left( f , \theta \right)= S\left( f \right)D\left( \theta \right)~~"/></p>
</div><p>where <img class="math" src="_images/math/fa8185cec12b266107deb62b15d8c2b227e617b9.png" alt="S\left( f\right)"/> is the wave power spectrum, <img class="math" src="_images/math/5b7752c757e0b691a80ab8227eadb8a8389dc58a.png" alt="f"/> is the wave frequency (in Hertz), <img class="math" src="_images/math/65115511afb6e573f6dfdf3a87a7ce5a4e0a0da4.png" alt="D\left( \theta \right)"/> is the directional distribution, and <img class="math" src="_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> is the wave direction (in Degrees). The formulation of <img class="math" src="_images/math/65115511afb6e573f6dfdf3a87a7ce5a4e0a0da4.png" alt="D\left( \theta \right)"/> requires that</p>
<div class="math">
<p><img src="_images/math/b12216f42d4b4003369346d7a3161c3b4372f1d0.png" alt="\int_{0}^{\infty}\int_{-\pi}^{\pi} S\left( f \right)D\left( \theta \right) d\theta df = \int_{0}^{\infty} S\left( f \right) df"/></p>
</div><p>so that the total energy in the directional spectrum must be the same as the total energy in the one-dimensional spectrum.</p>
<div class="math">
<p><img src="_images/math/3dabeb5ccbb2938e9d5d8f7a04d1f254617cc230.png" alt="S\left( f \right) = A f^{-5}\exp\left[-B f^{-4} \right]~~"/></p>
</div><p>where <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> and <img class="math" src="_images/math/4bc3e94a67870b41b7c20179693e889251e2c136.png" alt="B"/> are coefficients that vary depending on the wave spectrum and <img class="math" src="_images/math/c755ede1aedaee54d02072bdc6425d24c422bfe2.png" alt="\exp"/> stands for the exponential function. Spectral moments of the wave spectrum, denoted <img class="math" src="_images/math/8aea756808422e31cf1ee4aa5cc6a870ceebf983.png" alt="m_{k}~,~k=0, 1, 2,..."/>, are defined as</p>
<div class="math">
<p><img src="_images/math/63f0e57f38e9d79e0bb51e27256ad51a4d280178.png" alt="m_{k} = \int_{0}^{\infty} f^{k} S \left( f \right) df ~~"/></p>
</div><p>The spectral moment, <img class="math" src="_images/math/227d3347bb4a88066da9dd580c891f66b4f844fb.png" alt="m_{0}"/> is the variance of the free surface which allows one to define the mean wave height of the tallest third of waves, significant wave height  <img class="math" src="_images/math/86ff639c21f84d1489a1f027bbdf0b2f406fac51.png" alt="H_{m0}"/> (in m), as:</p>
<div class="math">
<p><img src="_images/math/27ed56ee90e28418eb4ad957b84484fabe8d3088.png" alt="H_{m0} = 4 \sqrt{m_{0}}~~"/></p>
</div><div class="section" id="pierson-moskowitz-pm">
<h4>Pierson–Moskowitz (PM)<a class="headerlink" href="#pierson-moskowitz-pm" title="Permalink to this headline">¶</a></h4>
<p>The PM spectrum is applicable to a fully developed sea, when the growth of the waves is not limited by the fetch <a class="bibtex reference internal" href="#pm" id="id19">[13]</a>. The two-parameter PM spectrum is based on a significant wave height and peak wave frequency.  For a given significant wave height, the peak frequency can be varied to cover a range of conditions including developing and decaying seas. In general, the parameters depend strongly on wind speed, and also wind direction, fetch, and locations of storm fronts. The spectral density of the surface elevation defined by the PM spectrum <a class="bibtex reference internal" href="#iec-2" id="id20">[14]</a> is defind by:</p>
<div class="math">
<p><img src="_images/math/f483eca741e1d9ddb0874b415e452fdf7247baa7.png" alt="S_{PM}\left( f \right) = \frac{{H_{m0}}^2}{4}\left(1.057f_{p}\right)^{4}f^{-5}\exp\left[-\frac{5}{4} \left( \frac{f_{p}}{f}\right)^{4} \right]~~ \\"/></p>
</div><p>This implies coefficients of the general form:</p>
<div class="math">
<p><img src="_images/math/62ad78ac83525e5ca494c5bb53f55b2b1e0bf888.png" alt="A =\frac{{H_{m0}}^2}{4}\left(1.057f_{p}\right)^{4} \approx \frac{5}{16} {H_{m0}}^2 {f_{p}}^{4} \approx \frac{B}{4}{H_{m0}}^2~~ \\
B = \left(1.057f_{p}\right)^{4} \approx \frac{5}{4}{f_{p}}^{4}~~ \\"/></p>
</div><p>where <img class="math" src="_images/math/86ff639c21f84d1489a1f027bbdf0b2f406fac51.png" alt="H_{m0}"/> is the significant wave height, <img class="math" src="_images/math/9178f41e0d746bbb926738a657c293d5f82df015.png" alt="f_{p}"/> is the peak wave frequency <img class="math" src="_images/math/9eec00b19c5d208df18276b41e8e13cef15ac013.png" alt="\left(=1/T_{p}\right)"/>, and <img class="math" src="_images/math/5b7752c757e0b691a80ab8227eadb8a8389dc58a.png" alt="f"/> is the wave frequency.</p>
</div>
<div class="section" id="jonswap-js">
<h4>JONSWAP (JS)<a class="headerlink" href="#jonswap-js" title="Permalink to this headline">¶</a></h4>
<p>The JONSWAP (Joint North Sea Wave Project) spectrum is formulated as a modification of the PM spectrum for developing sea sate in a fetch-limited situation <a class="bibtex reference internal" href="#hk" id="id21">[15]</a>. The spectrum accounts for a higher peak and a narrower spectrum in a storm situation for the same total energy as compared to the PM spectrum. The spectral density of the surface elevation defined by the JS spectrum <a class="bibtex reference internal" href="#iec-2" id="id22">[14]</a> is defined by:</p>
<div class="math">
<p><img src="_images/math/8df7cc1815f7b5b91ff48ef413640a772abaf0a3.png" alt="S_{JS}\left( f \right) = C \left(\gamma\right) S_{PM} \gamma^{\alpha} \\"/></p>
</div><p>where <img class="math" src="_images/math/34d137cf01c787ecda732761c3f95b0f65a6c3e9.png" alt="\gamma"/> is the non-dimensional peak-shape parameter.</p>
<p>The normalizing factor, <img class="math" src="_images/math/d703129a09fac6f841d9f9466927564f6da292e5.png" alt="C\left(\gamma\right)"/>, is defind as:</p>
<div class="math">
<p><img src="_images/math/93ea0df94fc4abd102297d5288a0827dbe487e83.png" alt="C\left(\gamma\right) = \frac{\int_{0}^{\infty}S_{PM}\left(f\right)df}{\int_{0}^{\infty}S_{PM}\left(f\right)\gamma^{\alpha}df} = 1 -0.287\ln\left(\gamma\right)\\"/></p>
</div><p>The peak-shape parameter exponent <img class="math" src="_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> is defined as:</p>
<div class="math">
<p><img src="_images/math/706dfccfeba8d1cb5d79e8b51d63a441b4904044.png" alt="\alpha = \exp \left[ -\left( \frac{\frac{f}{f_{p}}-1}{\sqrt{2} \sigma}\right)^{2} \right],~~ \sigma = \begin{cases} 0.07 &amp; f \leq f_{p} \\0.09 &amp; f &gt; f_{p} \end{cases} ~~ \\"/></p>
</div><p>The peak-shape parameter is defined based on the following relationship between the significant wave height, <img class="math" src="_images/math/86ff639c21f84d1489a1f027bbdf0b2f406fac51.png" alt="H_{m0}"/>, and peak period, <img class="math" src="_images/math/80da83d4192fe18f7db9221e8590bb109e30f956.png" alt="T_{p}"/>:</p>
<div class="math">
<p><img src="_images/math/b2f3c78c0e840b2871cd5eb82d5ac07f71fbe931.png" alt="\gamma = \begin{cases}
        5 &amp; \text{for } \frac{T_{p}}{\sqrt{H_{m0}}} \leq 3.6\\
        \exp\left(5.75 - 1.15\frac{T_{p}}{\sqrt{H_{m0}}} \right) &amp;  \text{for } 3.6 \leq \frac{T_{p}}{\sqrt{H_{m0}}} \leq 5 \\
        1 &amp; \text{for } \frac{T_{p}}{\sqrt{H_{m0}}} &gt; 5
\end{cases}"/></p>
</div><p>with general form coefficients thus defined:</p>
<div class="math">
<p><img src="_images/math/b88f285bb9a135cd6dbf7cf5c8b84e5f60231e77.png" alt="A = \frac{B}{4}{H_{m0}}^2 C\left(\gamma \right) \gamma^{\alpha} \\
B = \frac{5}{4}{f_{p}}^{4} \\"/></p>
</div></div>
</div>
</div>
<div class="section" id="power-take-off-pto">
<h2>Power Take-Off (PTO)<a class="headerlink" href="#power-take-off-pto" title="Permalink to this headline">¶</a></h2>
<p>Throughout the following sections, unless specification is made between linear and rotary PTOs, units are not explicitly stated.</p>
<div class="section" id="linear-pto">
<h3>Linear PTO<a class="headerlink" href="#linear-pto" title="Permalink to this headline">¶</a></h3>
<p>The PTO mechanism is represented as a linear spring-damper system where the reaction force is given by:</p>
<div class="math">
<p><img src="_images/math/679dfa82d31e7376c12a777bf089322216735bdb.png" alt="F_{pto}=-K{}_{pto}X_{rel}-C_{pto}\dot{X}_{rel}"/></p>
</div><p>where <img class="math" src="_images/math/a52e75ec90f11ec7e1a07ea9a4ef21e0ebbc5347.png" alt="K_{pto}"/> is the stiffness of the PTO, <img class="math" src="_images/math/ed4ed2e96d8c797623cc15cbb4433ff5a2e172cf.png" alt="C_{pto}"/> is the damping of the PTO, and <img class="math" src="_images/math/3f851132c0fa6b35943dbd109785bf8f7d5162c8.png" alt="X_{rel}"/> and <img class="math" src="_images/math/8ba8cdfcfa561a0a02b63248bd07611b364dbf8b.png" alt="\dot{X}_{rel}"/> are the relative motion and velocity between two bodies.
The instantaneous power absorbed by the PTO is given by:</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/c14e71a7eccd69d55393312f98c93f909d077731.png" alt="P_{pto} = -F_{pto}\dot{X}_{rel}=\left(K_{pto}X_{rel}\dot{X}_{rel}+C_{pto}\dot{X}^{2}_{rel}\right)"/></p>
</div></div></blockquote>
</div>
<div class="section" id="hydraulic-pto">
<h3>Hydraulic PTO<a class="headerlink" href="#hydraulic-pto" title="Permalink to this headline">¶</a></h3>
<p>The PTO mechanism is modeled as a hydraulic system <a class="bibtex reference internal" href="#so" id="id23">[16]</a>, where the reaction force is given by:</p>
<div class="math">
<p><img src="_images/math/86ea6ce8a8efaf27d237d315599b5aa295395510.png" alt="F_{pto}=\Delta{} p_{piston}A_{piston}"/></p>
</div><p>where <img class="math" src="_images/math/0fe53170b5bb95e4d1696d720f9d2ef79b1f2225.png" alt="\Delta{} p_{piston}"/> is the differential pressure of the hydraulic piston and <img class="math" src="_images/math/8309456a8d7a728be4c1ff87bd85918133f13c30.png" alt="A_{piston}"/> is the piston area.
The instantaneous hydraulic power absorbed by the PTO is given by:</p>
<div class="math">
<p><img src="_images/math/1c8e8be3c01675f0d360dec5dcc7f17c9088d994.png" alt="P_{pto}=-F_{pto}\dot{X}_{rel}"/></p>
</div></div>
<div class="section" id="mechanical-pto">
<h3>Mechanical PTO<a class="headerlink" href="#mechanical-pto" title="Permalink to this headline">¶</a></h3>
<p>The PTO mechanism is modeled as a direct-drive linear generator system <a class="bibtex reference internal" href="#so" id="id24">[16]</a>, where the reaction force is given by:</p>
<div class="math">
<p><img src="_images/math/66a6fb5b0712ddb47b443bf0ebc69034dbc11d35.png" alt="F_{pto}=(\frac{\pi}{\tau_{pm}})\lambda_{fd}i_{sq}"/></p>
</div><p>where <img class="math" src="_images/math/24c5c5eb8b8ae7ad8fa3dc1ef9ba106d2a4f0fbf.png" alt="\tau_{pm}"/> is the magnet pole pitch (the center-to-center distance of adjacent magnetic poles), <img class="math" src="_images/math/a33d74f42ab29d963854206cc22861f33560261e.png" alt="\lambda_{fd}"/> is the flux linkage of the stator <img class="math" src="_images/math/badad346f6fbe2e237af99bfbd9a93a4da53a3da.png" alt="d"/>-axis winding due to flux produced by the rotor magnets, and <img class="math" src="_images/math/6e766bc2d34bf1c120353bfcdf7b0abc373fb852.png" alt="i_{sq}"/> is the stator <img class="math" src="_images/math/a5fa84b363f309ebc8fe7db38304541732c7de9a.png" alt="q"/>-axis current.
The instantaneous mechanical power absorbed by the PTO is given by:</p>
<div class="math">
<p><img src="_images/math/1c8e8be3c01675f0d360dec5dcc7f17c9088d994.png" alt="P_{pto}=-F_{pto}\dot{X}_{rel}"/></p>
</div><p>For more information about application of pto systems in WEC-Sim, refer to <a class="reference internal" href="advanced_features.html#constraint-and-pto-features"><span class="std std-ref">Constraint and PTO Features</span></a> section.</p>
</div>
</div>
<div class="section" id="mooring">
<h2>Mooring<a class="headerlink" href="#mooring" title="Permalink to this headline">¶</a></h2>
<p>The mooring load is represented using a linear quasi-static mooring stiffness or by using the mooring forces calculated from <a class="reference external" href="http://www.matt-hall.ca/moordyn">MoorDyn</a> <a class="bibtex reference internal" href="#hall2015moordynguide" id="id25">[1]</a>, which is an open-source lumped-mass mooring dynamics model.</p>
<div class="section" id="mooring-matrix">
<h3>Mooring Matrix<a class="headerlink" href="#mooring-matrix" title="Permalink to this headline">¶</a></h3>
<p>When linear quasi-static mooring stiffness is used, the mooring load can be calculated by</p>
<div class="math">
<p><img src="_images/math/ee8cab5a6ead27a5d3d503588d07e296c50b0dd9.png" alt="F_{m}=-K_{m}X-C_{m}\dot{X}"/></p>
</div><p>where <img class="math" src="_images/math/92b18a95249ecf26f98ebc96f2bd01e71f640525.png" alt="K_{m}"/> and <img class="math" src="_images/math/bfd486dfabe357a9ba4514987ca487df94ef22b0.png" alt="C_{m}"/> are the stiffness and damping matrices for the mooring system, and <img class="math" src="_images/math/ed38fa24f1c94891bd312012aab3f6673be3eb83.png" alt="X"/> and <img class="math" src="_images/math/30be2b605c44fee9ec1ee785140bd3a4e404a30a.png" alt="\dot{X}"/> are the displacement and velocity of the body, respectively.</p>
</div>
<div class="section" id="id26">
<h3>MoorDyn<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>MoorDyn discretizes each mooring line in a mooring system into evenly-sized line segments connected by node points (see <a class="reference internal" href="#moordynfig"><span class="std std-ref">MoorDyn figure</span></a>). The line mass is lumped at these node points along with gravitational and buoyancy forces, hydrodynamic loads, and reactions from contact with the seabed.  Hydrodynamic drag and added mass are calculated based on Morison’s equation.  A mooring line’s axial stiffness is modeled by applying a linear stiffness to each line segment in tension only.  A damping term is also applied in each segment to dampen non-physical resonances caused by the lumped-mass discretization.  Bending and torsional stiffnesses are neglected.  Bottom contact is represented by vertical stiffness and damping forces applied at the nodes when a node is located below the seabed. <a class="bibtex reference internal" href="#hall2015validationdata" id="id27">[17]</a>.</p>
<div class="figure align-center" id="moordynfig">
<a class="reference internal image-reference" href="_images/MoorDyn_Graphic.png"><img alt="_images/MoorDyn_Graphic.png" src="_images/MoorDyn_Graphic.png" style="width: 529.1999999999999px; height: 324.79999999999995px;" /></a>
<div class="legend">
<p><em>MoorDyn mooring model elements</em></p>
</div>
</div>
<p>For more information about application of mooring systems in WEC-Sim, refer to <a class="reference internal" href="advanced_features.html#mooring-features"><span class="std std-ref">Mooring Features</span></a> section.</p>
</div>
</div>
<div class="section" id="nonlinear-buoynancy-and-froude-krylov-wave-excitation">
<h2>Nonlinear Buoynancy and Froude-Krylov Wave Excitation<a class="headerlink" href="#nonlinear-buoynancy-and-froude-krylov-wave-excitation" title="Permalink to this headline">¶</a></h2>
<p>The linear model assumes that the body motion and the waves consist of small amplitudes in comparison to the wavelengths. A weakly nonlinear approach is applied to account for the nonlinear hydrodynamic forces induced by the instantaneous water surface elevation and body position. Rather than using the BEM calculated linear wave-excitation and hydrostatic coefficients, the nonlinear buoyancy and the Froude-Krylov force components can be obtained by integrating the static and dynamic pressures over each panel along the wetted body surface at each time step.
Because linear wave theory is used to determine the flow velocity and pressure field, the values become unrealistically large for wetted panels that are above the mean water level. To correct this, the Wheeler stretching method is applied <a class="bibtex reference internal" href="#wheeler1969methods" id="id28">[18]</a>, which applies a correction to the instantaneous wave elevation that forces its height to be equal to the water depth when calculating the flow velocity and pressure,</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/592d057ccefb54c91218bd6643668eb4547499b6.png" alt="z^* = \frac{D(D+z)}{(D+\eta)} - D"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/> is the mean water depth, and <img class="math" src="_images/math/97db043c7cba573ac389b71add78b048077e8a13.png" alt="\eta"/> is the z-value on the instantaneous water surface.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The nonlinear WEC-Sim method is not intended to model highly nonlinear hydrodynamic events, such as wave slamming and wave breaking.</p>
</div>
<p>For more information about application of nonlinear hydrodynamics in WEC-Sim, refer to <a class="reference internal" href="advanced_features.html#nonlinear"><span class="std std-ref">Nonlinear Buoyancy and Froude-Krylov Excitation</span></a> section.</p>
</div>
<div class="section" id="viscous-damping-and-morison-elements">
<h2>Viscous Damping and Morison Elements<a class="headerlink" href="#viscous-damping-and-morison-elements" title="Permalink to this headline">¶</a></h2>
<p>Additional damping and added-mass can be added to the WEC system. This facilitates experimental validation of the WEC-Sim code, particularly in the event that the BEM hydrodynamic outputs are not sufficiently representative of the physical system.</p>
<div class="section" id="viscous-damping">
<h3>Viscous Damping<a class="headerlink" href="#viscous-damping" title="Permalink to this headline">¶</a></h3>
<p>Linear damping and quadratic drag forces add flexibility to the definition of viscous forcing</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/f003d75ca187941bc77c2e22b0a58080f37be868.png" alt="&amp; F_{v}=-C_{v}\dot{X}-\frac{C_{d} \rho A_{d}}{2}\dot{X}|\dot{X}| &amp; \\

&amp;  =-C_{v}\dot{X}-C_{D}\dot{X}|\dot{X}| &amp; \\"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/81c370adae7bfbc836880b7115ffc7b9c92a3a82.png" alt="C_{v}"/> is the linear (viscous) damping coefficient, <img class="math" src="_images/math/0ee6ec7e6594bdb065fc8f19e8bc898cdd0bb90e.png" alt="C_{d}"/> is the quadratic drag coefficient, <img class="math" src="_images/math/27dc86f9f1b1c3435b2403a869b5870c582facea.png" alt="\rho"/> is the fluid density, and <img class="math" src="_images/math/b35271d230caa136d8a80047a67c866dfcd4a2e0.png" alt="A_{d}"/> is the characteristic area for drag calculation. Alternatively, one can define <img class="math" src="_images/math/90c5b090c46495c59d7e3e8752681ae1da6abcbd.png" alt="C_{D}"/> directly.</p>
<p>Because BEM codes are potential flow solvers and neglect the effects of viscosity, <img class="math" src="_images/math/95fba5399bf21be9e58aa677a945db3675097a30.png" alt="F_{v}"/> generally must be included to accurately model device performance. However, it can be difficult to select representative drag coefficients, as they depend on device geometry, scale, and relative velocity between the body and the flow around it. Empirical data on the drag coefficient can be found in various literature and standards, but is generally limited to simple geometries evaluated at a limited number of scales and flow conditions. For realistic device geometries, the use of computational fluid dynamic simulations or experimental data is encouraged.</p>
</div>
<div class="section" id="morison-elements">
<h3>Morison Elements<a class="headerlink" href="#morison-elements" title="Permalink to this headline">¶</a></h3>
<p>The Morison Equation assumes that the fluid forces in an oscillating flow on a structure of slender cylinders or other similar geometries arise partly from pressure effects from potential flow and partly from viscous effects. A slender cylinder implies that the diameter, D, is small relative to the wave length, <img class="math" src="_images/math/cefc603e5658facb747581f9567192993f21c7ab.png" alt="\lambda"/>, which is generally met when <img class="math" src="_images/math/3e85b75b0395fc54456cf6e9ee27a71deac5b38f.png" alt="D/\lambda &lt; 0.1 - 0.2"/>. If this condition is not met, wave diffraction effects must be taken into account. Assuming that the geometries are slender, the resulting force can be approximated by a modified Morison formulation <a class="bibtex reference internal" href="#morison1950" id="id29">[19]</a>. The formulation for each element on the body can be given as</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/8496142a68ba05096de033650b358ddd2ee62832.png" alt="F_{me}=\rho\forall\dot{v}+\rho\forall C_{a}(\dot{v}-\ddot{X})+\frac{C_{d}\rho A_{d}}{2}(v-\dot{X})|v-\dot{X}|"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/02d98909b5d6acd6a7ff927d4d42790bdd407d58.png" alt="v"/> is the fluid particle velocity due to wave and current, <img class="math" src="_images/math/1e111d033507e2f72d06e9b090a9abc10ddcadad.png" alt="C_{a}"/> is the coefficient of added mass, and <img class="math" src="_images/math/3c1f4a382e7e70b8ca20c3d1f3b372276b1e9f5e.png" alt="\forall"/> is the displaced volume.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>WEC-Sim  does not consider buoyancy effects when calculating the forces from Morison elements.</p>
</div>
<p>For more information about application of Morison Elements in WEC-Sim, refer to <a class="reference internal" href="advanced_features.html#morison"><span class="std std-ref">Morison Elements</span></a> section.</p>
</div>
</div>
<div class="section" id="generalized-body-modes">
<h2>Generalized Body Modes<a class="headerlink" href="#generalized-body-modes" title="Permalink to this headline">¶</a></h2>
<p>Additional generalized body modes (GBM) are inlcuded to account for solving multibody system with relative body motions or the the dynamics and structural deformation, assuming the modal properties are given or can be simply obtained in closed-form expressions or finite element analysis. Once the hydrodynamic coefficients that include these additional flexible DOF are obtained from the BEM solver, the 6DOF rigid body motion for each body and the additional GBM DOFs are solved together in one system of equations.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-theory-0"><dl class="citation">
<dt class="bibtex label" id="hall2015moordynguide"><span class="brackets"><a class="fn-backref" href="#id25">1</a></span></dt>
<dd><p>Matthew Hall. Moordyn user’s guide. 2015.</p>
</dd>
<dt class="bibtex label" id="li2012"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Ye Li and Yi-Hsiang Yu. A Synthesis of Numerical Methods for Modeling Wave Energy Converter-Point Absorbers. <em>Renewable and Sustainable Energy Reviews</em>, 16(6):4352–4364, 2012.</p>
</dd>
<dt class="bibtex label" id="babarit2012"><span class="brackets">3</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id9">2</a>)</span></dt>
<dd><p>Aurélien Babarit, J. Hals, M.J. Muliawan, A. Kurniawan, T. Moan, and J. Krokstad. Numerical Benchmarking Study of a Selection of Wave Energy Converters. <em>Renewable Energy</em>, 41:44–63, 2012.</p>
</dd>
<dt class="bibtex label" id="lee2006"><span class="brackets">4</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id8">2</a>)</span></dt>
<dd><p>CH Lee and JN Newman. WAMIT User Manual. 2006.</p>
</dd>
<dt class="bibtex label" id="aqwa"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>ANSYS Aqwa. URL: <a class="reference external" href="http://www.ansys.com/Products/Other+Products/ANSYS+AQWA">http://www.ansys.com/Products/Other+Products/ANSYS+AQWA</a>.</p>
</dd>
<dt class="bibtex label" id="nemoh"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><p>Nemoh a Open source BEM. URL: <a class="reference external" href="http://openore.org/tag/nemoh/">http://openore.org/tag/nemoh/</a>.</p>
</dd>
<dt class="bibtex label" id="nolte2014"><span class="brackets"><a class="fn-backref" href="#id10">7</a></span></dt>
<dd><p>Jerica D. Nolte and R. C. Ertekin. Wave power calculations for a wave energy conversion device connected to a drogue. <em>Journal of Renewable and Sustainable Energy</em>, 2014.</p>
</dd>
<dt class="bibtex label" id="cummins1962"><span class="brackets"><a class="fn-backref" href="#id11">8</a></span></dt>
<dd><p>WE Cummins. The Impulse Response Function and Ship Motions. Technical Report, David Taylor Model Dasin-DTNSRDC, 1962.</p>
</dd>
<dt class="bibtex label" id="yu1996"><span class="brackets"><a class="fn-backref" href="#id12">9</a></span></dt>
<dd><p>Z. Yu and J. Falnes. State-space Modelling of a Vertical Cylinder in Heave. <em>Applied Ocean Research</em>, 5:265–275, 1996.</p>
</dd>
<dt class="bibtex label" id="taghipour2008"><span class="brackets">10</span><span class="fn-backref">(<a href="#id13">1</a>,<a href="#id15">2</a>,<a href="#id17">3</a>)</span></dt>
<dd><p>R. Taghipour, T. Perez, and T. Moan. Hybrid Frequency-time Domain Models for Dynamic Response Analysis of Marine Structures. <em>Ocean Engineering</em>, 7:685–705, 2008.</p>
</dd>
<dt class="bibtex label" id="kung1978"><span class="brackets"><a class="fn-backref" href="#id14">11</a></span></dt>
<dd><p>Sun-Yuan Kung. A new identification and model reduction algorithm via singular value decomposition. In <em>Proc. 12th Asilomar Conf. Circuits, Syst. Comput., Pacific Grove, CA</em>, 705–714. 1978.</p>
</dd>
<dt class="bibtex label" id="kristiansen2005"><span class="brackets">12</span><span class="fn-backref">(<a href="#id16">1</a>,<a href="#id18">2</a>)</span></dt>
<dd><p>Erlend Kristiansen, Åsmund Hjulstad, and Olav Egeland. State-space representation of radiation forces in time-domain vessel models. <em>Ocean Engineering</em>, 32(17):2195–2216, 2005.</p>
</dd>
<dt class="bibtex label" id="pm"><span class="brackets"><a class="fn-backref" href="#id19">13</a></span></dt>
<dd><p>W. J. Pierson and L. A. Moskowitz. Proposed Spectral Form for Fully Developed Wind Seas Based on the Similarity Theory of S. A. Kitaigorodskii. <em>Geophysical Research</em>, 69:5181–5190, 1964.</p>
</dd>
<dt class="bibtex label" id="iec-2"><span class="brackets">14</span><span class="fn-backref">(<a href="#id20">1</a>,<a href="#id22">2</a>)</span></dt>
<dd><p>IEC 62600-2. Marine Energy - Wave, Tidal, and other water current converters. URL: <a class="reference external" href="https://webstore.iec.ch/publication/62399">https://webstore.iec.ch/publication/62399</a>.</p>
</dd>
<dt class="bibtex label" id="hk"><span class="brackets"><a class="fn-backref" href="#id21">15</a></span></dt>
<dd><p>K. Hasselman, T.P. Barnett, E. Bouws, H. Carlson, D.E. Cartwright, K. Enke, J.A. Ewing, H. Gienapp, D.E. Hasselmann, P. Kruseman, A. Meerburg, P. Mller, D.J. Olbers, K. Richter, W. Sell, and H. Walden. Measurements of wind-wave growth and swell decay during the Joint North Sea Wave Project (JONSWAP). Technical Report 12, German Hydrographic Institute, 1973.</p>
</dd>
<dt class="bibtex label" id="so"><span class="brackets">16</span><span class="fn-backref">(<a href="#id23">1</a>,<a href="#id24">2</a>)</span></dt>
<dd><p>R. So, A. Simmons, T. Brekken, K. Ruehl, and C. Michelen. Development of PTO-SIM: A Power Performance Module for the Open-Souse Wave Energy Converter Code WEC-SIM. In <em>Proceedings of OMAE 2015</em>. 2015.</p>
</dd>
<dt class="bibtex label" id="hall2015validationdata"><span class="brackets"><a class="fn-backref" href="#id27">17</a></span></dt>
<dd><p>Matthew Hall and Andrew Goupee. Validation of a lumped-mass mooring line model with deepcwind semisubmersible model test data. <em>Ocean Engineering</em>, 104:590–603, 2015.</p>
</dd>
<dt class="bibtex label" id="wheeler1969methods"><span class="brackets"><a class="fn-backref" href="#id28">18</a></span></dt>
<dd><p>J D Wheeler and others. Methods for calculating forces produced by irregular waves. In <em>Offshore Technology Conference</em>. 1969.</p>
</dd>
<dt class="bibtex label" id="morison1950"><span class="brackets"><a class="fn-backref" href="#id29">19</a></span></dt>
<dd><p>J R Morison, M P O’brien, J W Johnson, and S A Schaaf. The force exerted by surface waves on piles. <em>Petroleum Transactions, AIME</em>, 189:149–154, 1950.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_structure.html" class="btn btn-neutral float-right" title="Code Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2014, National Renewable Energy Laboratory and National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS)

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-88158104-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>